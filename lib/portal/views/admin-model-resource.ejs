angular.module('<%=model.module.resource%>', ['ngResource'])
  .factory('<%=model.name%>', function($resource) {
    var temp = $resource('<%=model.route%>', 
                          null, 
                          {
                            create: {
                              method: '<%=createVerb%>'
                            }
                          });
    temp.prototype.create = function(cb) {
      return temp.create({id: undefined}, angular.extend({}, this, {_id:undefined}), cb);
    };
    temp.prototype.save = function(cb) {};

    return temp;
  })
  <%for (var i in model.models){
    var _model = model.models[i];
  %>
    .factory('<%=_model.name%>', function($resource) {
      var temp;
      <%if (_model.isArray){%>
        temp = $resource('<%=_model.route%>', 
                              null, 
                              {
                                create: {
                                  method: '<%=createVerb%>'
                                }
                              });
        temp.prototype.create = function(cb) {
          return temp.create(<%=_model.identifiers%>, angular.extend({}, this, {_id:undefined}), cb);
        };
        temp.prototype.query = function(cb) {
          return temp.query(<%=_model.identifiers%>, null`, cb);
        };
        temp.prototype.save = function(cb) {};
      <%}else{%>
        temp = $resource('<%=_model.route%>', 
                              null, 
                              {
                                save: {
                                  method: '<%=updateVerb%>'
                                }
                              });
        temp.prototype.save = function(cb) {
          return temp.save(<%=_model.identifiers%>, angular.extend({}, this, {_id:undefined}), cb);
        };
        temp.prototype.remove = function(cb) {};
        temp.prototype.delete = function(cb) {};
      <%}%>
      
      return temp;
    })
  <%}%>
  ;